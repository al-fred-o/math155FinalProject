---
title: "Data Exploration" 
output: html_document 
--- 

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.width=12, fig.height=8) 

library(ggplot2)
library(TSA)
library(readr)
```

## Importing/Processing Data

```{r}
data <- read_csv("sales_revenue_clean.csv")
```


```{r}
data$Tot_Sale
x = as.numeric(data$Tot_Sales)
x
```



```{r}
# time = seq(as.Date("1990-01-01"), as.Date("2021-01-01"), by="months")
totalSales <- ts(data$Tot_Sales,start=c(1990,1),frequency=12)
totalRev <- ts(data$Tot_Revenue,start=c(1990,1),frequency=12)
totalPrice <- ts(data$Tot_Price,start=c(1990,1),frequency=12)


rSales <- ts(data$R_Sales,start=c(1990,1),frequency=12)
rRev <- ts(data$R_Revenue,start=c(1990,1),frequency=12)
rPrice <- ts(data$R_Price,start=c(1990,1),frequency=12)

cSales <- ts(data$C_Sales,start=c(1990,1),frequency=12)
cRev <- ts(data$C_Revenue,start=c(1990,1),frequency=12)
cPrice <- ts(data$C_Price,start=c(1990,1),frequency=12)

iSales <- ts(data$I_Sales,start=c(1990,1),frequency=12)
iRev <- ts(data$I_Revenue,start=c(1990,1),frequency=12)
iPrice <- ts(data$I_Price,start=c(1990,1),frequency=12)

tSales <- ts(data$T_Sales,start=c(1990,1),frequency=12)
tRev <- ts(data$T_Revenue,start=c(1990,1),frequency=12)
tPrice <- ts(data$T_Price,start=c(1990,1),frequency=12)

oSales <- ts(data$O_Sales,start=c(1990,1),frequency=12)
oRev <- ts(data$O_Revenue,start=c(1990,1),frequency=12)
oPrice <- ts(data$O_Price,start=c(1990,1),frequency=12)
```


## Initial Plot of Data

### Plots of Residential Data

```{r}

Month=c('J','F','M','A','M','J','J','A','S','O','N','D')

plot(rSales, main = "Residential Sales")
points(rSales,pch=Month)
```

```{r}

plot(rRev, main = "Residential Revenue")
points(rRev,pch=Month)
```

### Plots of Total Data

```{r}
Month=c('J','F','M','A','M','J','J','A','S','O','N','D')

plot(totalSales, main = "Total Sales")
points(totalSales,pch=Month)

plot(totalPrice, main = "Total Price")
points(totalPrice,pch=Month)
```

```{r}
totalMA = filter(totalSales,rep(1,13)/13,sides=2) # 1 year MA
plot(cbind(totalMA),plot.type='single',col=4:1,lwd=2, ylab="flow", main = "Total MA" )
lines(totalSales)

rMA = filter(rSales,rep(1,13)/13,sides=2) # 1 year MA
plot(cbind(rMA),plot.type='single',col=4:1,lwd=2, ylab="flow", main = "Residential MA")
lines(rSales)

cMA = filter(cSales,rep(1,13)/13,sides=2) # 1 year MA
plot(cbind(cMA),plot.type='single',col=4:1,lwd=2, ylab="flow", main = "C MA")
lines(cSales)

iMA = filter(iSales,rep(1,13)/13,sides=2) # 1 year MA
plot(cbind(iMA),plot.type='single',col=4:1,lwd=2, ylab="flow", main = "Industrial MA")
lines(iSales)
```

```{r}
plot(cbind(totalMA,rMA,cMA, iMA),plot.type='single',col=4:1,lwd=2, ylab="sales")
# green is residential
# red is c
# black is industrial
```

```{r}
bc = BoxCox.ar(totalSales)
```



