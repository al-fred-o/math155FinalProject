---
title: "Forecasting" 
output: html_document 
--- 

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.width=8, fig.height=5) 

library(ggplot2)
library(TSA)
library(readr)
```

```{r}
data <- read_csv("sales_revenue_clean.csv")
totalRev <- ts(data$C_Revenue,start=c(1990,1),frequency=12)
```

```{r}
actual = window(totalRev, start = c(2019,1))
series = window(totalRev, start = c(1990,2), end = c(2019,1))

model = arima(series,order = c(0,1,2), seasonal = list(order=c(0,1,1),period= 12))
model
```

```{r}
num = length(actual)
res = plot(model,n.ahead=num, n1 = c(2015,2))
points(actual,pch=2) 
abline(h=coef(model)[names(coef(model))=='intercept'])
```


```{r}
forecast=res$pred
plot(actual, pch = 2, type = "o")
points(forecast)
```



